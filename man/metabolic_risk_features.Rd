% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metabolic_risk_features.R
\name{metabolic_risk_features}
\alias{metabolic_risk_features}
\title{Calculate metabolic risk feature flags (pediatric-friendly thresholds)}
\usage{
metabolic_risk_features(
  data,
  col_map = NULL,
  na_action = c("keep", "omit", "error", "ignore", "warn"),
  na_warn_prop = 0.2,
  check_extreme = FALSE,
  extreme_action = c("warn", "cap", "error", "ignore", "NA"),
  extreme_rules = NULL,
  verbose = FALSE
)
}
\arguments{
\item{data}{A data.frame or tibble containing at least these numeric columns:
\itemize{
\item chol_total, chol_ldl, chol_hdl, triglycerides (mmol/L)
\item age_year (years)
\item z_HOMA (standardized HOMA-IR)
\item glucose (mmol/L)
\item HbA1c (mmol/mol; IFCC units)
\item bp_sys_z, bp_dia_z (BP z-scores)
}}

\item{col_map}{Optional named list to map required keys to column names in \code{data}.
Keys: c("chol_total","chol_ldl","chol_hdl","triglycerides","age_year",
"z_HOMA","glucose","HbA1c","bp_sys_z","bp_dia_z"). Default NULL (use same names).}

\item{na_action}{One of c("keep","omit","error","ignore","warn") controlling missing-data policy.
\itemize{
\item "keep": keep NA; outputs become NA where inputs are NA.
\item "omit": drop rows with NA in any required input.
\item "error": abort if any required input contains NA.
\item "ignore"/"warn": aliases of "keep"; "warn" also emits missingness diagnostics.
}}

\item{na_warn_prop}{Numeric in \eqn{[0,1]}; per-variable threshold for high-missingness warnings. Default 0.2.}

\item{check_extreme}{Logical; if TRUE, scan inputs for out-of-range values (see \code{extreme_rules}). Default FALSE.}

\item{extreme_action}{One of c("warn","cap","error","ignore","NA") used when extremes are detected
(only when \code{check_extreme = TRUE}).
\itemize{
\item "warn": only warn (default), "cap": truncate to range and warn,
\item "error": abort, "ignore": do nothing, "NA": set flagged inputs to NA.
}}

\item{extreme_rules}{Optional named list of c(min,max) ranges for required keys. If NULL, broad defaults are used.}

\item{verbose}{Logical; if TRUE, prints stepwise messages and a final summary. Default FALSE.}
}
\value{
A tibble with four factor columns (levels c("0","1")):
\itemize{
\item dyslipidemia
\item insulin_resistance
\item hyperglycemia
\item hypertension
}
}
\description{
Compute four binary risk flags from routine clinical measures:
\itemize{
\item dyslipidemia
\item insulin_resistance
\item hyperglycemia (prediabetes-range glycemia)
\item hypertension (BP >=95th percentile via z > 1.64)
}
}
\details{
By default, behavior matches prior implementation: required columns are
validated, NA values are kept (propagate to outputs), no extreme-value
checks or capping are applied, and a tibble with 0/1 factor flags is returned.

Units and criteria (no automatic unit conversion):
\itemize{
\item Lipids (mmol/L): total cholesterol > 5.2 OR LDL-C > 3.4 OR HDL-C < 1.0 OR
triglycerides > 1.1 (age 0-9) OR > 1.5 (age 10-19) => dyslipidemia = 1.
\item Insulin resistance: z_HOMA > 1.28 (~=90th percentile) => insulin_resistance = 1.
z_HOMA is a within-sample or external z-score of HOMA-IR.
\item Hyperglycemia: fasting glucose in (5.6, 6.9) mmol/L OR HbA1c in (39, 47) mmol/mol
=> hyperglycemia = 1.
\item Hypertension: either BP z-score > 1.64 (~=95th percentile) for systolic or diastolic
=> hypertension = 1.
}
}
\seealso{
\code{\link[=liver_markers]{liver_markers()}}, \code{\link[=lipid_markers]{lipid_markers()}}, \code{\link[=kidney_failure_risk]{kidney_failure_risk()}}, \code{\link[=inflammatory_markers]{inflammatory_markers()}}
}
