---
title: "HealthMarkers"
output:
  rmarkdown::github_document:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = "#", collapse = TRUE)
```

<!-- badges: start -->
[![R-CMD-check](https://github.com/sufyansuleman/HealthMarkers/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/sufyansuleman/HealthMarkers/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

# HealthMarkers

HealthMarkers is an R toolkit for deriving and standardizing a wide range of physiological biomarkers with consistent validation, NA handling, and diagnostics. It unifies insulin sensitivity/resistance indices, lipid and liver panels, renal and pulmonary markers, micronutrient/vitamin metrics, cardiovascular risk scores, and more into one pipeline.

This README focuses on the essentials for getting started. For deep dives, see the vignettes in `doc/` and the pkgdown site.

---

## Installation

```r
# CRAN release
install.packages("HealthMarkers")

# Development version
# remotes::install_github("sufyansuleman/HealthMarkers")
```

---

## Key capabilities (high level)

- Insulin panels: fasting, OGTT, adipose, tracer/DXA, and composite insulin indices.
- Cardiometabolic panels: lipid and liver markers, metabolic syndrome severity, risk scores.
- Renal, pulmonary, bone, inflammatory, vitamin, nutrient, and frailty indices.
- Aggregators: `all_insulin_indices()`, `metabolic_markers()`, and `all_health_markers()` bind outputs safely, skip failing groups, and reuse inferred mappings when possible.
- Consistent helpers: input validation (`hm_validate_inputs()`), column inference (`hm_infer_cols()`), extreme-value handling, and classed errors for testing.

---

## Quick start

```r
library(HealthMarkers)
library(tibble)

# Minimal lipid + liver example
labs <- tibble(
  TC = c(200, 180), HDL_c = c(50, 60), TG = c(150, 110), LDL_c = c(120, 100),
  ALT = c(30, 25), AST = c(20, 18), BMI = c(25, 27), age = c(45, 52), sex = c("F", "M")
)

res <- all_health_markers(
  data = labs,
  col_map = list(
    TC = "TC", LDL_c = "LDL_c", HDL_c = "HDL_c", TG = "TG",
    ALT = "ALT", AST = "AST", BMI = "BMI", age = "age", sex = "sex"
  ),
  which = c("lipid", "liver"),
  include_insulin = FALSE,
  verbose = TRUE
)

res
```

---

## Working with column maps

Most functions accept `col_map`, a named list mapping required keys to your dataset’s column names. If you omit `col_map` in aggregators like `all_health_markers()`, the package attempts to infer common columns using `hm_infer_cols()`; supply the map explicitly when you want reproducible behavior or when your names are unconventional.

---

## Minimal per-function usage (pointers)

- Insulin indices: `fasting_is()`, `ogtt_is()`, `adipo_is()`, `tracer_dxa_is()`, `all_insulin_indices()`.
- Cardiometabolic: `lipid_markers()`, `liver_markers()`, `metabolic_risk_features()`, `metss()`.
- Glycemic and mixed panels: `glycemic_markers()`, `pulmo_markers()`, `urine_markers()`, `kidney_kfre()`, `frailty_index()`, `charlson_index()`.
- Vitamins/nutrients: `vitamin_markers()`, `vitamin_d_status()`, `nutrient_markers()`.

See function help pages (`?fasting_is`, `?all_health_markers`, etc.) and vignettes for full argument sets and references.

---

## Testing and development

- Vignettes live in `doc/` (built) and `vignettes/` (sources). Knit locally with `devtools::build_vignettes()`.
- Run checks with `devtools::check()`; a GitHub Actions workflow mirrors CRAN checks.
- Classed errors (`healthmarkers_*`) make unit testing specific conditions straightforward.

---

## Contributing

Issues and pull requests are welcome. Please add minimal examples, unit tests, and, when applicable, a short vignette entry for new user-facing helpers. Follow the existing style for validation, NA handling, and messaging.

---

## License

MIT © Sufyan Suleman

