---
title: "nfl_marker"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{nfl_marker}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(comment = "#", collapse = TRUE)
knitr::opts_knit$set(purl = FALSE)
```

## Overview

`nfl_marker()` is a placeholder wrapper for Neurofilament Light Chain (NfL). It validates inputs, offers NA and extreme-handling policies, and returns the provided NfL values (no scoring/classification). Units are assumed to match input (e.g., plasma pg/mL); no conversion is performed.

## Inputs

- `data`: data.frame/tibble containing an NfL column.
- `col_map`: named list mapping `nfl` to the NfL column (default `NfL`). Column must exist; values must be numeric (coerced with warnings if not).

## Arguments

- `na_action = c("keep","omit","error","ignore","warn")`: missing-data policy (`ignore`/`warn` behave like `keep`; `omit` drops rows; `error` aborts).
- `check_extreme = FALSE`: optional range scan.
- `extreme_action = c("warn","cap","error","ignore","NA")`: handling for extremes when scanning (`cap` truncates; `NA` blanks values).
- `extreme_rules = NULL`: override default `list(nfl = c(0, 1e6))` in input units.
- `verbose = FALSE`: emit progress messages.

## Output

Returns a tibble with one column `nfl_value`, reflecting the input after optional NA/exreme handling. When `na_action = "omit"`, rows with missing NfL are removed; otherwise those rows yield `NA`.

## Examples

```{r}
library(HealthMarkers)
library(tibble)

df <- tibble(NfL = c(12.5, 18.2, NA, 450000))

nfl_marker(
  data = df,
  col_map = list(nfl = "NfL"),
  na_action = "keep",
  check_extreme = FALSE,
  verbose = FALSE
)
```

## Examples

Scan for extremes and cap while warning, keeping all rows:

```{r}
nfl_marker(
  data = df,
  col_map = list(nfl = "NfL"),
  na_action = "warn",
  check_extreme = TRUE,
  extreme_action = "cap",
  verbose = TRUE
)
```

## Notes

- Negative NfL values trigger a warning and propagate as-is (or NA if capped/blanked by policies).
- This function does not apply age adjustment, centiles, or clinical thresholds; it is a pass-through with validation.
- Adjust `extreme_rules` to align with your assay range if different from the broad default.
